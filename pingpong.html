<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Ping Pong Pasto</title>
    <style>
        body { background: #222; color: white; text-align: center; font-family: sans-serif; }
        
        /* Contenedor de botones fuera del canvas */
        .menu-externo {
            background: #333;
            padding: 20px;
            margin-bottom: 10px;
            border-bottom: 4px solid #4CAF50;
        }

        button {
            padding: 15px 30px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            margin: 0 10px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 8px;
        }

        button:hover { background: #66bb6a; }

        canvas { 
            border: 5px solid white; 
            background-color: #2e7d32;
            /* Efecto de pasto simple */
            background-image: linear-gradient(rgba(255,255,255,.05) 50%, transparent 50%);
            background-size: 100% 50px;
        }

        #mensaje { font-size: 24px; color: #ccff00; margin-top: 10px; }
    </style>
</head>
<body>

    <div class="menu-externo">
        <h1>PONG DE PASTO</h1>
        <button id="btnBot">ðŸ‘¤ Jugar vs BOT</button>
        <button id="btnAmigo">ðŸ‘¥ Jugar vs AMIGO</button>
        <p>Controles: Jugador 1 (W/S) | Jugador 2 (Flechas)</p>
    </div>

    <canvas id="pong" width="800" height="400"></canvas>
    <div id="mensaje">Selecciona un modo para empezar</div>

    <script>
        const canvas = document.getElementById("pong");
        const ctx = canvas.getContext("2d");
        const mensaje = document.getElementById("mensaje");

        let gameActive = false;
        let isMultiplayer = false;

        // Objetos
        const player = { x: 10, y: 160, w: 10, h: 80, score: 0 };
        const enemy = { x: 780, y: 160, w: 10, h: 80, score: 0 };
        const ball = { x: 400, y: 200, r: 8, dx: 0, dy: 0 };

        // Teclas
        const keys = {};
        window.onkeydown = (e) => keys[e.key] = true;
        window.onkeyup = (e) => keys[e.key] = false;

        // EVENTOS DE CLIC (Directos a los IDs)
        document.getElementById("btnBot").onclick = function() { start(false); };
        document.getElementById("btnAmigo").onclick = function() { start(true); };

        function start(multi) {
            isMultiplayer = multi;
            player.score = 0;
            enemy.score = 0;
            gameActive = true;
            mensaje.innerText = multi ? "MODO: 2 JUGADORES" : "MODO: CONTRA BOT";
            resetBall();
        }

        function resetBall() {
            ball.x = 400; ball.y = 200;
            ball.dx = (Math.random() > 0.5 ? 4 : -4);
            ball.dy = (Math.random() > 0.5 ? 4 : -4);
        }

        function update() {
            if (!gameActive) return;

            // Mover Jugador 1
            if (keys['w'] && player.y > 0) player.y -= 7;
            if (keys['s'] && player.y < canvas.height - player.h) player.y += 7;

            // Mover Enemigo
            if (isMultiplayer) {
                if (keys['ArrowUp'] && enemy.y > 0) enemy.y -= 7;
                if (keys['ArrowDown'] && enemy.y < canvas.height - enemy.h) enemy.y += 7;
            } else {
                // Bot inteligente
                if (enemy.y + enemy.h/2 < ball.y - 10) enemy.y += 5;
                else if (enemy.y + enemy.h/2 > ball.y + 10) enemy.y -= 5;
            }

            ball.x += ball.dx;
            ball.y += ball.dy;

            if (ball.y < 0 || ball.y > canvas.height) ball.dy *= -1;

            // Colisiones
            if (ball.x < player.x + player.w && ball.y > player.y && ball.y < player.y + player.h) ball.dx = Math.abs(ball.dx) * 1.1;
            if (ball.x > enemy.x - player.w && ball.y > enemy.y && ball.y < enemy.y + enemy.h) ball.dx = -Math.abs(ball.dx) * 1.1;

            if (ball.x < 0) { enemy.score++; resetBall(); }
            if (ball.x > 800) { player.score++; resetBall(); }
            
            if (player.score >= 5 || enemy.score >= 5) {
                gameActive = false;
                mensaje.innerText = (player.score >= 5 ? "Â¡GANÃ“ JUGADOR 1!" : "Â¡GANÃ“ RIVAL!");
            }
        }

        function draw() {
            ctx.fillStyle = "#2e7d32";
            ctx.fillRect(0,0,800,400);
            
            ctx.fillStyle = "white";
            ctx.fillRect(400, 0, 2, 400); // LÃ­nea central
            ctx.fillRect(player.x, player.y, player.w, player.h);
            ctx.fillRect(enemy.x, enemy.y, enemy.w, enemy.h);
            
            ctx.fillStyle = "#ccff00"; // Pelota tenis
            ctx.beginPath();
            ctx.arc(ball.x, ball.y, ball.r, 0, Math.PI*2);
            ctx.fill();

            ctx.font = "30px Arial";
            ctx.fillText(player.score, 350, 40);
            ctx.fillText(enemy.score, 430, 40);

            update();
            requestAnimationFrame(draw);
        }

        draw();
    </script>
</body>
</html>